VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "Sheet1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Option Explicit


Sub execute()
    Dim strAnkeDataPath As String
    strAnkeDataPath = "data-アンケート結果"
    Dim strAnkeDataOutPath As String
    strAnkeDataOutPath = "data-アンケート結果集計"
    Dim strAnkeDataOutFilename As String
    strAnkeDataOutFilename = "アンケート結果集計.xlsx"

    Call syuukeiAnketo(strAnkeDataPath, strAnkeDataOutPath, strAnkeDataOutFilename)
End Sub

Sub syuukeiAnketo(strAnkeDataPath As String, strAnkeDataOutPath As String, strAnkeDataOutFilename As String)
    
    
    Dim wordFiles As String
    wordFiles = strAnkeDataPath & "\*.docx"

    Dim fileName As String
    fileName = Dir(wordFiles)

    Do While fileName <> ""
        Dim wordFile As String
        wordFile = ThisWorkbook.Path & "\" & strAnkeDataPath & "\" & fileName
        
        Dim wdApp As Word.Application
        Dim wdDoc As Word.Document
        Set wdApp = CreateObject("Word.Application")
        wdApp.Visible = True
        Set wdDoc = wdApp.Documents.Open(wordFile)
        
        Dim countTables As Integer
        countTables = wdDoc.Tables.Count
        If countTables = 6 Then
            Dim txt As String
            txt = wdDoc.Tables(1).Range.Cells(2).Range.Text
            Debug.Print txt
            txt = wdDoc.Tables(2).Range.Cells(2).Range.Text
            Debug.Print txt
            txt = wdDoc.Tables(3).Range.Cells(1).Range.Text
            Debug.Print txt
            txt = wdDoc.Tables(4).Range.Cells(1).Range.Text
            Debug.Print txt
            txt = wdDoc.Tables(5).Range.Cells(1).Range.Text
            Debug.Print txt
            txt = wdDoc.Tables(6).Range.Cells(1).Range.Text
            Debug.Print txt
            
        End If
        
        If countTables = 5 Then
            
        End If
      
        wdDoc.Close
        Call wdApp.Quit
        Set wdApp = Nothing
        
        fileName = Dir()
    Loop

End Sub


Sub devided()
    Dim strFile As String
    strFile = ThisWorkbook.Path & "\" & "data-mgs" & "\" & "（返信）RE_ 社内報アンケートについてのご依頼(nozaki).msg"

    With CreateObject("Scripting.FileSystemObject")
        Dim olApp As Object
        Set olApp = CreateObject("Outlook.Application")
    
        With OutlookApp.GetNamespace("MAPI")
            Set Item = .OpenSharedItem(strFile)
            Select Case LCase(TypeName(Item))
                Case "mailitem"
                    
            End Select
        End With
    
    End With
    Dim msg As Object
    Set msg = olApp.CreateItemFromTemplate(strFile)
    
End Sub


