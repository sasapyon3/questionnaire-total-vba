VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "Sheet1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Option Explicit

' 手順：
' Step1: アンケート回答（Word）をすべてExcelに集計する
' Step2: 集計結果を、提出フォーマットに追記 & アンケート回答関連ファイルを対応IDにリネーム


Sub executeStep1()
    Dim strBaseDataFolderName As String
    strBaseDataFolderName = "data"
    
    ' アンケート回答
    Dim strQuestionnaireFolderName As String
    strQuestionnaireFolderName = "questionnaire"
    
    ' アンケート集計
    Dim strQuestionnaireTotalFolderName As String
    strQuestionnaireTotalFolderName = "total"
    Dim strQuestionnaireTotalFileName As String
    strQuestionnaireTotalFileName = "questionnaire-total.xlsx"
    
    
    Dim strQuestionnaireFolderPath As String
    strQuestionnaireFolderPath = strBaseDataFolderName & strQuestionnaireFolderName
    Dim strQuestionnaireTotalFolderPath As String
    strQuestionnaireTotalFolderPath = strBaseDataFolderName & strQuestionnaireTotalFolderName
    Dim strQuestionnaireTotalFilePath As String
    strQuestionnaireTotalFilePath = strBaseDataFolderName & strQuestionnaireTotalFileName

    Call syuukeiAnketo(strQuestionnaireFolderPath, strQuestionnaireTotalFolderPath, strQuestionnaireTotalFilePath)
End Sub

Sub aggregatesyuukeiQuestionnaire(strQuestionnaireFolderPath As String, strQuestionnaireTotalFolderPath As String, strQuestionnaireTotalFilePath As String)
    
    
    Dim wordFiles As String
    wordFiles = strQuestionnaireFolderPath & "\*.docx"

    Dim fileName As String
    fileName = Dir(wordFiles)

    Do While fileName <> ""
        Dim wordFile As String
        wordFile = ThisWorkbook.Path & "\" & strQuestionnaireFolderPath & "\" & fileName
        
        Dim wdApp As Word.Application
        Dim wdDoc As Word.Document
        Set wdApp = CreateObject("Word.Application")
        wdApp.Visible = True
        Set wdDoc = wdApp.Documents.Open(wordFile)
        
        Dim countTables As Integer
        countTables = wdDoc.Tables.Count
        If countTables = 6 Then
            Dim txt As String
            txt = wdDoc.Tables(1).Range.Cells(2).Range.Text
            Debug.Print txt
            txt = wdDoc.Tables(2).Range.Cells(2).Range.Text
            Debug.Print txt
            txt = wdDoc.Tables(3).Range.Cells(1).Range.Text
            Debug.Print txt
            txt = wdDoc.Tables(4).Range.Cells(1).Range.Text
            Debug.Print txt
            txt = wdDoc.Tables(5).Range.Cells(1).Range.Text
            Debug.Print txt
            txt = wdDoc.Tables(6).Range.Cells(1).Range.Text
            Debug.Print txt
            
        End If
        
        If countTables = 5 Then
            
        End If
      
        wdDoc.Close
        Call wdApp.Quit
        Set wdApp = Nothing
        
        fileName = Dir()
    Loop

End Sub

